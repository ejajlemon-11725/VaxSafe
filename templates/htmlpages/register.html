{% extends 'base.html' %}
{% block title %}Register - VaxSafe{% endblock %}
{% load static %}
{% block content %}

<div class="register-page">
  <div class="register-container">
    <div class="register-card">
      <div class="card-header">
        <h2>Create Account</h2>
        <p class="subtitle">Join VaxSafe and protect your family's health</p>
      </div>

      {% if messages %}
        <div class="messages">
          {% for message in messages %}
            <div class="message {{ message.tags }}">
              <i class="fa {% if message.tags == 'success' %}fa-check-circle{% else %}fa-exclamation-circle{% endif %}"></i>
              <span>{{ message }}</span>
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <form method="post" onsubmit="return validateForm()">
        {% csrf_token %}

        <div class="form-group">
          <div class="input-wrapper">
            <i class="fa fa-user"></i>
            <input type="text" name="full_name" placeholder="Full Name" required>
          </div>
        </div>

        <div class="form-group">
          <div class="input-wrapper">
            <i class="fa fa-envelope"></i>
            <input type="email" name="email" placeholder="Email Address" required>
          </div>
        </div>

        <div class="form-group">
          <div class="input-wrapper">
            <i class="fa fa-lock"></i>
            <input type="password" id="password" name="password" placeholder="Password" required>
          </div>
        </div>

        <div class="form-group">
          <div class="input-wrapper">
            <i class="fa fa-lock"></i>
            <input type="password" id="confirm_password" name="reset_password" placeholder="Confirm Password" required>
          </div>
        </div>

        <button type="submit" class="btn-create">
          <span>Create Account</span>
          <i class="fa fa-arrow-right"></i>
        </button>

        <a href="{% url 'home' %}" class="btn-back">
          <i class="fa fa-arrow-left"></i>
          <span>Back to Home</span>
        </a>
      </form>

      <div class="login-link">
        <p>Already have an account? <a href="{% url 'login' %}" class="login-text">Log In</a></p>
      </div>
    </div>
  </div>
</div>

<style>
/* ============================================
   REGISTER PAGE - Modern Medical Design
   ============================================ */
.register-page {
  min-height: calc(100vh - 80px);
  background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40px 20px;
}

.register-container {
  width: 100%;
  max-width: 480px;
}

/* Register Card */
.register-card {
  background: white;
  padding: 45px 40px;
  border-radius: 25px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
  border-top: 5px solid transparent;
  border-image: linear-gradient(to right, #1976d2, #26a69a, #66bb6a, #42a5f5) 1;
  animation: slideUp 0.5s ease;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Card Header */
.card-header {
  text-align: center;
  margin-bottom: 35px;
}

.card-header h2 {
  font-size: 32px;
  font-weight: bold;
  color: #1565c0;
  margin-bottom: 10px;
}

.card-header .subtitle {
  font-size: 15px;
  color: #546e7a;
  margin: 0;
}

/* Messages */
.messages {
  margin-bottom: 25px;
}

.message {
  padding: 14px 18px;
  border-radius: 12px;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 14px;
  animation: slideIn 0.3s ease;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.message.success {
  background: rgba(102, 187, 106, 0.15);
  color: #2e7d32;
  border-left: 4px solid #66bb6a;
}

.message.error {
  background: rgba(239, 83, 80, 0.15);
  color: #c62828;
  border-left: 4px solid #ef5350;
}

.message i {
  font-size: 18px;
}

/* Form Groups */
.form-group {
  margin-bottom: 20px;
}

.input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

.input-wrapper i {
  position: absolute;
  left: 18px;
  color: #78909c;
  font-size: 16px;
  z-index: 1;
}

.input-wrapper input {
  width: 100%;
  padding: 16px 20px 16px 50px;
  border: 2px solid #cfd8dc;
  border-radius: 15px;
  font-size: 15px;
  color: #37474f;
  outline: none;
  transition: all 0.3s ease;
  background: #ffffff;
  box-sizing: border-box;
}

.input-wrapper input:focus {
  border-color: #1976d2;
  box-shadow: 0 0 0 4px rgba(25, 118, 210, 0.1);
  transform: translateY(-2px);
}

.input-wrapper input:focus + i {
  color: #1976d2;
}

.input-wrapper input::placeholder {
  color: #90a4ae;
}

/* Buttons - SAME SIZE */
.btn-create,
.btn-back {
  width: 100%;
  padding: 16px 30px;
  border-radius: 15px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  text-decoration: none;
  border: none;
  box-sizing: border-box;
}

.btn-create {
  background: linear-gradient(135deg, #1976d2 0%, #0d47a1 100%);
  color: white;
  box-shadow: 0 6px 20px rgba(25, 118, 210, 0.4);
  margin-bottom: 12px;
}

.btn-create:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(25, 118, 210, 0.5);
}

.btn-create i {
  transition: transform 0.3s ease;
}

.btn-create:hover i {
  transform: translateX(5px);
}

.btn-back {
  background: transparent;
  color: #1976d2;
  border: 2px solid #1976d2;
}

.btn-back:hover {
  background: #1976d2;
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(25, 118, 210, 0.3);
}

.btn-back i {
  transition: transform 0.3s ease;
}

.btn-back:hover i {
  transform: translateX(-5px);
}

/* Login Link */
.login-link {
  text-align: center;
  margin-top: 25px;
  padding-top: 25px;
  border-top: 1px solid #e0e0e0;
}

.login-link p {
  font-size: 15px;
  color: #546e7a;
  margin: 0;
}

.login-link .login-text {
  color: #1976d2;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.3s ease;
}

.login-link .login-text:hover {
  color: #0d47a1;
  text-decoration: underline;
}

/* ============================================
   RESPONSIVE DESIGN
   ============================================ */
@media (max-width: 576px) {
  .register-card {
    padding: 35px 25px;
  }

  .card-header h2 {
    font-size: 26px;
  }

  .card-header .subtitle {
    font-size: 14px;
  }

  .input-wrapper input {
    padding: 14px 18px 14px 45px;
    font-size: 14px;
  }

  .btn-create,
  .btn-back {
    padding: 14px 25px;
    font-size: 15px;
  }
}
</style>

<script>
function validateForm() {
  let pass = document.getElementById("password").value;
  let confirmPass = document.getElementById("confirm_password").value;

  if (pass !== confirmPass) {
    // Create a custom message element
    const messagesDiv = document.querySelector('.messages') || (() => {
      const div = document.createElement('div');
      div.className = 'messages';
      document.querySelector('form').insertBefore(div, document.querySelector('form').firstChild);
      return div;
    })();

    messagesDiv.innerHTML = `
      <div class="message error">
        <i class="fa fa-exclamation-circle"></i>
        <span>Passwords do not match!</span>
      </div>
    `;

    // Scroll to the message
    messagesDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

    return false;
  }
  return true;
}

// Remove error message when user starts typing
document.addEventListener('DOMContentLoaded', function() {
  const inputs = document.querySelectorAll('input');
  inputs.forEach(input => {
    input.addEventListener('input', function() {
      const errorMessage = document.querySelector('.message.error');
      if (errorMessage) {
        errorMessage.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => errorMessage.remove(), 300);
      }
    });
  });
});
</script>

{% endblock %}